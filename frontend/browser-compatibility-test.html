<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browser Compatibility Test - Eco Donations</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
            line-height: 1.6;
        }
        .header {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .test-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .browser-info {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .test-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        .test-item:last-child {
            border-bottom: none;
        }
        .status {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
        }
        .pass { background: #28a745; }
        .fail { background: #dc3545; }
        .warn { background: #ffc107; color: #333; }
        .unknown { background: #6c757d; }
        .test-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            background: #007bff;
            color: white;
            cursor: pointer;
            font-size: 14px;
            margin-left: 10px;
        }
        .test-btn:hover {
            background: #0056b3;
        }
        .results-summary {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-top: 20px;
        }
        .feature-test {
            margin: 10px 0;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .compatibility-matrix {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .compatibility-matrix th,
        .compatibility-matrix td {
            padding: 8px 12px;
            text-align: center;
            border: 1px solid #ddd;
        }
        .compatibility-matrix th {
            background: #f8f9fa;
            font-weight: 600;
        }
        @media (max-width: 768px) {
            .test-grid {
                grid-template-columns: 1fr;
            }
            .compatibility-matrix {
                font-size: 12px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üåê Cross-Browser Compatibility Test</h1>
        <p>Test Eco-Donations across different browsers and platforms</p>
    </div>

    <div class="browser-info">
        <h3>üîç Detected Browser Information</h3>
        <div id="browser-detection"></div>
    </div>

    <div class="test-grid">
        <div class="test-card">
            <h3>üß™ Feature Detection Tests</h3>
            <div id="feature-tests"></div>
        </div>

        <div class="test-card">
            <h3>üîó Wallet Compatibility</h3>
            <div id="wallet-tests"></div>
        </div>

        <div class="test-card">
            <h3>üé® CSS Feature Tests</h3>
            <div id="css-tests"></div>
        </div>

        <div class="test-card">
            <h3>üì± Mobile Browser Tests</h3>
            <div id="mobile-tests"></div>
        </div>
    </div>

    <div class="test-grid">
        <div class="test-card">
            <h3>üîß Manual Test Checklist</h3>
            <div id="manual-tests">
                <div class="test-item">
                    <span>Navigation menu works</span>
                    <div>
                        <span class="status unknown" id="nav-test" onclick="toggleTest('nav-test')">?</span>
                        <button class="test-btn" onclick="testNavigation()">Test</button>
                    </div>
                </div>
                <div class="test-item">
                    <span>Wallet connection functional</span>
                    <div>
                        <span class="status unknown" id="wallet-test" onclick="toggleTest('wallet-test')">?</span>
                        <button class="test-btn" onclick="testWallet()">Test</button>
                    </div>
                </div>
                <div class="test-item">
                    <span>Forms submit correctly</span>
                    <div>
                        <span class="status unknown" id="form-test" onclick="toggleTest('form-test')">?</span>
                        <button class="test-btn" onclick="testForms()">Test</button>
                    </div>
                </div>
                <div class="test-item">
                    <span>Charts/graphs display</span>
                    <div>
                        <span class="status unknown" id="chart-test" onclick="toggleTest('chart-test')">?</span>
                        <button class="test-btn" onclick="testCharts()">Test</button>
                    </div>
                </div>
                <div class="test-item">
                    <span>Responsive layout works</span>
                    <div>
                        <span class="status unknown" id="responsive-test" onclick="toggleTest('responsive-test')">?</span>
                        <button class="test-btn" onclick="testResponsive()">Test</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="test-card">
            <h3>üìä Performance Tests</h3>
            <div id="performance-tests"></div>
        </div>
    </div>

    <div class="results-summary">
        <h3>üìã Browser Compatibility Matrix</h3>
        <table class="compatibility-matrix">
            <thead>
                <tr>
                    <th>Feature</th>
                    <th>Chrome</th>
                    <th>Safari</th>
                    <th>Firefox</th>
                    <th>Edge</th>
                    <th>Mobile Chrome</th>
                    <th>Mobile Safari</th>
                </tr>
            </thead>
            <tbody id="compatibility-matrix">
                <tr>
                    <td>Web3/Ethereum</td>
                    <td id="chrome-web3">?</td>
                    <td id="safari-web3">?</td>
                    <td id="firefox-web3">?</td>
                    <td id="edge-web3">?</td>
                    <td id="mobile-chrome-web3">?</td>
                    <td id="mobile-safari-web3">?</td>
                </tr>
                <tr>
                    <td>CSS Grid</td>
                    <td id="chrome-grid">?</td>
                    <td id="safari-grid">?</td>
                    <td id="firefox-grid">?</td>
                    <td id="edge-grid">?</td>
                    <td id="mobile-chrome-grid">?</td>
                    <td id="mobile-safari-grid">?</td>
                </tr>
                <tr>
                    <td>ES6 Modules</td>
                    <td id="chrome-es6">?</td>
                    <td id="safari-es6">?</td>
                    <td id="firefox-es6">?</td>
                    <td id="edge-es6">?</td>
                    <td id="mobile-chrome-es6">?</td>
                    <td id="mobile-safari-es6">?</td>
                </tr>
                <tr>
                    <td>Local Storage</td>
                    <td id="chrome-storage">?</td>
                    <td id="safari-storage">?</td>
                    <td id="firefox-storage">?</td>
                    <td id="edge-storage">?</td>
                    <td id="mobile-chrome-storage">?</td>
                    <td id="mobile-safari-storage">?</td>
                </tr>
            </tbody>
        </table>

        <div id="test-summary"></div>
    </div>

    <script>
        class BrowserCompatibilityTester {
            constructor() {
                this.results = {};
                this.init();
            }

            init() {
                this.detectBrowser();
                this.runFeatureTests();
                this.runWalletTests();
                this.runCSSTests();
                this.runMobileTests();
                this.runPerformanceTests();
                this.updateCompatibilityMatrix();
            }

            detectBrowser() {
                const userAgent = navigator.userAgent;
                const browserInfo = {
                    name: 'Unknown',
                    version: 'Unknown',
                    platform: navigator.platform,
                    mobile: /Mobi|Android/i.test(userAgent),
                    webgl: !!window.WebGLRenderingContext,
                    webgl2: !!window.WebGL2RenderingContext
                };

                // Detect browser
                if (userAgent.includes('Chrome') && !userAgent.includes('Edg')) {
                    browserInfo.name = 'Chrome';
                    browserInfo.version = userAgent.match(/Chrome\/(\d+)/)?.[1] || 'Unknown';
                } else if (userAgent.includes('Safari') && !userAgent.includes('Chrome')) {
                    browserInfo.name = 'Safari';
                    browserInfo.version = userAgent.match(/Version\/(\d+)/)?.[1] || 'Unknown';
                } else if (userAgent.includes('Firefox')) {
                    browserInfo.name = 'Firefox';
                    browserInfo.version = userAgent.match(/Firefox\/(\d+)/)?.[1] || 'Unknown';
                } else if (userAgent.includes('Edg')) {
                    browserInfo.name = 'Edge';
                    browserInfo.version = userAgent.match(/Edg\/(\d+)/)?.[1] || 'Unknown';
                }

                document.getElementById('browser-detection').innerHTML = `
                    <strong>Browser:</strong> ${browserInfo.name} ${browserInfo.version}<br>
                    <strong>Platform:</strong> ${browserInfo.platform}<br>
                    <strong>Mobile:</strong> ${browserInfo.mobile ? 'Yes' : 'No'}<br>
                    <strong>WebGL:</strong> ${browserInfo.webgl ? 'Supported' : 'Not supported'}<br>
                    <strong>User Agent:</strong> ${userAgent}
                `;

                this.browserInfo = browserInfo;
            }

            runFeatureTests() {
                const tests = [
                    {
                        name: 'ES6 Arrow Functions',
                        test: () => {
                            try {
                                eval('() => {}');
                                return true;
                            } catch (e) {
                                return false;
                            }
                        }
                    },
                    {
                        name: 'Async/Await',
                        test: () => {
                            try {
                                eval('async function test() { await Promise.resolve(); }');
                                return true;
                            } catch (e) {
                                return false;
                            }
                        }
                    },
                    {
                        name: 'Fetch API',
                        test: () => typeof fetch !== 'undefined'
                    },
                    {
                        name: 'Local Storage',
                        test: () => {
                            try {
                                localStorage.setItem('test', 'test');
                                localStorage.removeItem('test');
                                return true;
                            } catch (e) {
                                return false;
                            }
                        }
                    },
                    {
                        name: 'Web3 Support',
                        test: () => typeof window.ethereum !== 'undefined'
                    },
                    {
                        name: 'WebSocket',
                        test: () => typeof WebSocket !== 'undefined'
                    }
                ];

                const container = document.getElementById('feature-tests');
                container.innerHTML = tests.map(test => {
                    const result = test.test();
                    const statusClass = result ? 'pass' : 'fail';
                    const statusText = result ? '‚úì' : '‚úï';
                    return `
                        <div class="feature-test">
                            <span class="status ${statusClass}">${statusText}</span>
                            ${test.name}: <strong>${result ? 'Supported' : 'Not Supported'}</strong>
                        </div>
                    `;
                }).join('');
            }

            runWalletTests() {
                const tests = [
                    {
                        name: 'MetaMask Detection',
                        test: () => typeof window.ethereum !== 'undefined' && window.ethereum.isMetaMask
                    },
                    {
                        name: 'Web3 Provider',
                        test: () => typeof window.ethereum !== 'undefined'
                    },
                    {
                        name: 'EIP-1193 Support',
                        test: () => typeof window.ethereum?.request === 'function'
                    }
                ];

                const container = document.getElementById('wallet-tests');
                container.innerHTML = tests.map(test => {
                    const result = test.test();
                    const statusClass = result ? 'pass' : 'warn';
                    const statusText = result ? '‚úì' : '!';
                    return `
                        <div class="feature-test">
                            <span class="status ${statusClass}">${statusText}</span>
                            ${test.name}: <strong>${result ? 'Available' : 'Not Available'}</strong>
                        </div>
                    `;
                }).join('');
            }

            runCSSTests() {
                const tests = [
                    {
                        name: 'CSS Grid',
                        test: () => CSS.supports('display', 'grid')
                    },
                    {
                        name: 'CSS Flexbox',
                        test: () => CSS.supports('display', 'flex')
                    },
                    {
                        name: 'CSS Custom Properties',
                        test: () => CSS.supports('--custom-property', 'value')
                    },
                    {
                        name: 'CSS Transforms',
                        test: () => CSS.supports('transform', 'translateX(1px)')
                    },
                    {
                        name: 'CSS Animations',
                        test: () => CSS.supports('animation', 'none')
                    }
                ];

                const container = document.getElementById('css-tests');
                container.innerHTML = tests.map(test => {
                    const result = test.test();
                    const statusClass = result ? 'pass' : 'fail';
                    const statusText = result ? '‚úì' : '‚úï';
                    return `
                        <div class="feature-test">
                            <span class="status ${statusClass}">${statusText}</span>
                            ${test.name}: <strong>${result ? 'Supported' : 'Not Supported'}</strong>
                        </div>
                    `;
                }).join('');
            }

            runMobileTests() {
                const isMobile = this.browserInfo.mobile;
                const tests = [
                    {
                        name: 'Touch Events',
                        test: () => 'ontouchstart' in window
                    },
                    {
                        name: 'Device Orientation',
                        test: () => 'orientation' in window
                    },
                    {
                        name: 'Viewport Meta Support',
                        test: () => !!document.querySelector('meta[name="viewport"]')
                    }
                ];

                const container = document.getElementById('mobile-tests');
                if (isMobile) {
                    container.innerHTML = tests.map(test => {
                        const result = test.test();
                        const statusClass = result ? 'pass' : 'warn';
                        const statusText = result ? '‚úì' : '!';
                        return `
                            <div class="feature-test">
                                <span class="status ${statusClass}">${statusText}</span>
                                ${test.name}: <strong>${result ? 'Available' : 'Not Available'}</strong>
                            </div>
                        `;
                    }).join('');
                } else {
                    container.innerHTML = '<p>Mobile tests only available on mobile devices</p>';
                }
            }

            runPerformanceTests() {
                const container = document.getElementById('performance-tests');
                
                // Measure page load performance
                const navigation = performance.getEntriesByType('navigation')[0];
                const loadTime = navigation ? navigation.loadEventEnd - navigation.fetchStart : 0;
                
                // Memory usage (if available)
                const memory = performance.memory;
                
                container.innerHTML = `
                    <div class="feature-test">
                        <span class="status ${loadTime < 3000 ? 'pass' : 'warn'}">${loadTime < 3000 ? '‚úì' : '!'}</span>
                        Page Load Time: <strong>${loadTime ? Math.round(loadTime) + 'ms' : 'N/A'}</strong>
                    </div>
                    ${memory ? `
                    <div class="feature-test">
                        <span class="status pass">‚úì</span>
                        Memory Usage: <strong>${Math.round(memory.usedJSHeapSize / 1048576)}MB</strong>
                    </div>
                    ` : ''}
                `;
            }

            updateCompatibilityMatrix() {
                const currentBrowser = this.browserInfo.name.toLowerCase();
                
                // Update current browser column
                const features = ['web3', 'grid', 'es6', 'storage'];
                const tests = {
                    web3: typeof window.ethereum !== 'undefined',
                    grid: CSS.supports('display', 'grid'),
                    es6: true, // Modern browsers support ES6
                    storage: !!window.localStorage
                };

                features.forEach(feature => {
                    const result = tests[feature];
                    const cell = document.getElementById(`${currentBrowser}-${feature}`);
                    if (cell) {
                        cell.innerHTML = result ? '‚úÖ' : '‚ùå';
                        cell.style.backgroundColor = result ? '#d4edda' : '#f8d7da';
                    }
                });
            }
        }

        // Manual test functions
        function toggleTest(testId) {
            const element = document.getElementById(testId);
            const current = element.textContent;
            
            if (current === '?') {
                element.textContent = '‚úì';
                element.className = 'status pass';
            } else if (current === '‚úì') {
                element.textContent = '‚úï';
                element.className = 'status fail';
            } else {
                element.textContent = '?';
                element.className = 'status unknown';
            }
        }

        function testNavigation() {
            window.open('index.html', '_blank');
        }

        function testWallet() {
            if (typeof window.ethereum !== 'undefined') {
                window.ethereum.request({ method: 'eth_accounts' })
                    .then(() => {
                        document.getElementById('wallet-test').textContent = '‚úì';
                        document.getElementById('wallet-test').className = 'status pass';
                    })
                    .catch(() => {
                        document.getElementById('wallet-test').textContent = '‚úï';
                        document.getElementById('wallet-test').className = 'status fail';
                    });
            } else {
                alert('No wallet detected');
            }
        }

        function testForms() {
            window.open('donate.html', '_blank');
        }

        function testCharts() {
            window.open('dashboard.html', '_blank');
        }

        function testResponsive() {
            window.open('responsive-test.html', '_blank');
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', () => {
            new BrowserCompatibilityTester();
        });
    </script>
</body>
</html>
